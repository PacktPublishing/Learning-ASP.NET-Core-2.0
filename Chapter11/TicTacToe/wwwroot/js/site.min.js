function EmailConfirmation(n){window.WebSocket?openSocket(n,"Email"):interval=setInterval(()=>{CheckEmailConfirmationStatus(n)},5e3)}function GameInvitationConfirmation(n){window.WebSocket?openSocket(n,"GameInvitation"):interval=setInterval(()=>{CheckGameInvitationConfirmationStatus(n)},5e3)}function CheckEmailConfirmationStatus(n){$.get("/CheckEmailConfirmationStatus?email="+n,function(t){t==="OK"&&(interval!==null&&clearInterval(interval),window.location.href="/GameInvitation?email="+n)})}function CheckGameInvitationConfirmationStatus(n){$.get("/GameInvitationConfirmation?id="+n,function(t){t.result==="OK"&&(interval!==null&&clearInterval(interval),window.location.href="/GameSession/Index/"+n)})}function SetGameSession(n,t){window.GameSessionId=n;window.EmailPlayer=t;window.TurnNumber=0}function SendPosition(n,t,i,r){var u=document.location.port?":"+document.location.port:"",f=document.location.protocol+"//"+document.location.hostname+u+"/restApi/v1/SetGamePosition/"+n,e={Email:t,x:i,y:r},o=JSON.stringify(e);$.ajax({url:f,accepts:"application/json; charset=utf-8",contentType:"application/json",data:o,dataType:"json",type:"POST"})}function EnableCheckTurnIsFinished(){interval=setInterval(()=>{CheckTurnIsFinished()},2e3)}function CheckTurnIsFinished(){var n=document.location.port?":"+document.location.port:"",t=document.location.protocol+"//"+document.location.hostname+n+"/restapi/v1/GetGameSession/"+window.GameSessionId;$.get(t,function(n){n.turnFinished===!0&&n.turnNumber>=window.TurnNumber&&(CheckGameSessionIsFinished(),ChangeTurn(n))})}function ChangeTurn(n){var t=n.turns[n.turnNumber-1];DisplayImageTurn(t);$("#activeUser").text(n.activeUser.email);n.activeUser.email!==window.EmailPlayer?DisableBoard(n.turnNumber):EnableBoard(n.turnNumber)}function DisableBoard(n){var t=$("#gameBoard");t.hide();$("#divAlertWaitTurn").show();window.TurnNumber=n}function EnableBoard(n){var t=$("#gameBoard");t.show();$("#divAlertWaitTurn").hide();window.TurnNumber=n}function DisplayImageTurn(n){var i=$("#c_"+n.y+"_"+n.x),t;t=n.iconNumber==="1"?"glyphicon glyphicon-unchecked":"glyphicon glyphicon-remove-circle";i.html('<i class="'+t+'"><\/i>')}function CheckGameSessionIsFinished(){var n=document.location.port?":"+document.location.port:"",t=document.location.protocol+"//"+document.location.hostname+n+"/restapi/v1/CheckGameSessionIsFinished/"+window.GameSessionId;$.get(t,function(t){(t.indexOf("won")>0||t=="The game was a draw.")&&(alert(t),window.location.href=document.location.protocol+"//"+document.location.hostname+n)})}var interval,openSocket=function(n,t){var i;interval!==null&&clearInterval(interval);var f=location.protocol==="https:"?"wss:":"ws:",r="",u="";t=="Email"?(u=f+"//"+window.location.host+"/CheckEmailConfirmationStatus",r="CheckEmailConfirmationStatus"):t=="GameInvitation"&&(u=f+"//"+window.location.host+"/GameInvitationConfirmation",r="CheckGameInvitationConfirmationStatus");i=new WebSocket(u);i.onmessage=function(i){if(console.log(i),t=="Email"&&i.data=="OK")window.location.href="/GameInvitation?email="+n;else if(t=="GameInvitation"){var r=$.parseJSON(i.data);r.Result=="OK"&&(window.location.href="/GameSession/Index/"+r.Id)}};i.onopen=function(){var t=JSON.stringify({Operation:r,Parameters:n});i.send(t)};i.onclose=function(){}};$(document).ready(function(){$(".btn-SetPosition").click(function(){var n=$(this).attr("data-X"),t=$(this).attr("data-Y");SendPosition(window.GameSessionId,window.EmailPlayer,n,t)})});